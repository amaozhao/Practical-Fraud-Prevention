# BORIS 和 BOPIS 欺诈

> 给早期发行版读者的注意事项
> 使用早期发布的电子书，你可以获得最早形式的书籍——作者在写作时的原始和未经编辑的内容——因此你可以在这些书名正式发布之前很久就利用这些技术。
> 这将是最后一本书的第 9 章。
> 如果你对我们如何改进本书中的内容和/或示例有任何意见，或者如果你发现本章中缺少材料，请通过 ccollins@oreily.com 与编辑联系。

本章着眼于与在线购买-店内提货 (BOPIS) 和在线购买-店内退货 (BORIS) 计划相关的欺诈行为。我们在这些定义中包括了因 Covid-19 大流行而流行的路边选项，特别关注大流行实践带来的额外风险。
从欺诈者的角度来看，BOPIS 的巨大优势在于它可以规避上一章中讨论的运输挑战。如果你在店内取货，则无需提供送货地址——这意味着欺诈者无需想办法使用与他们付款方式的账单地址相匹配的地址。偷了。他们只是去商店取货。
一些公司会接受带有任何帐单地址的信用卡，只要它来自正确的国家/地区而无需进一步检查。他们知道，好客户经常订购货物到他们工作地点附近取货，这可能离他们的家庭地址很远，有时会使用 BOPIS 将物品发送给家人或朋友，或者让家人或朋友为他们取件当他们访问时它会在那里。他们这样做可能是因为他们在逗留期间会想要某件物品，或者因为它在他们自己的地区无法买到，或者是为了避税。所有这些都是完全合法的活动。但是，不进行检查确实会让欺诈者的事情变得更容易。
对于那些确实在计费/提货差异很大时执行检查的公司（并且欺诈者知道并分享这些公司的身份），欺诈者使用前一章中讨论过的久经考验的骡子取货方法（骡子是欺诈者雇用的人）执行重复性或仅要求他们住在特定位置的任务）。骡子也是解决不设在当地的欺诈者进行的 BOPIS 欺诈的解决方案——它们是欺诈者扩大影响范围和扩大规模的好方法。
骡子也经常用于攻击 BORIS 程序——返回物品，通常以换取现金。如果这是在初次购买后不久完成的，这可能是利用被盗支付信息进行的购买获利的好方法。一些骗子以自己的名义这样做，攻击自己当地的商店（使用相当广泛的“本地”定义），但真正有问题的是那些使用骡子扩大规模的人——潜在的损失简直太远了更高。从某种意义上说，这种类型的欺诈是前一章中介绍的基于骡子的计划的一个子集。
BOPIS 和 BORIS 计划共享两个额外的元素，这使得欺诈预防特别具有挑战性。首先，它们被公司推广为方便客户使用，这意味着它们必须流畅和快速。这不会为识别过程留下太多时间。与客户互动的人（从而在实地打电话询问是否允许取货或退货）不是欺诈预防专家。在许多公司中，他们无法获得有关取货或退货客户的欺诈评分或风险因素的任何信息。
自从这些计划开始以来，BOPIS 和 BORIS 欺诈就一直存在。正如我们希望现在应该清楚的那样，一旦有机会，欺诈者就会利用它。多年来，BOPIS 和 BORIS 欺诈仍然相对少见。也许欺诈者只是担心被抓两次——一次是在网上，一次是在结账时，一次是在现实生活中，一次是在取货时。被央视抓到的风险，以及当地执法部门愿意并且能够在店内对犯罪行为采取行动的事实（相对于网络案件阻止执法行动的复杂管辖权要素），所有这些加起来都使得这种欺诈对欺诈者的吸引力较小。
然而，欺诈者已经慢慢开始转向这个渠道的欺诈，这可能是因为它比以前更常见了，因为在大流行期间推出了 BOPIS 和 BORIS 计划的商店越来越多。这些通常包括路边取货的选项，为顾客提供一种替代店内购物的选择，因为店内购物已经变得没有吸引力。与此同时，门店也减少了身份识别的要求，尽量减少面对面的接触，以承认顾客戴着口罩的事实，并加快了因突然流行而给店内团队带来巨大压力的过程。 . BOPIS 和 BORIS 通常在路边，然后变得更容易被欺诈者利用，并且这些领域的欺诈行为也相应增加。人气的增长也导致了传统主题的新变化：结合账户接管 (ATO)，欺诈者检查他们接管的账户，以查看订单何时作为 BOPIS 订单下达，然后要么自己走，要么发送在客户到达那里之前，骡子拿起订单。
尽管有大流行的压力，但这些仍然是相对罕见的欺诈形式（例如，与简单的在线信用卡被盗使用或帐户接管相比），但现在已经足够强大，以至于许多曾经感到安全无视它们的商店已经采取了措施保护他们的业务——尤其是那些销售相对高价商品的业务。

## 识别和缓解

识别和减轻 BOPIS 和 BORIS 欺诈分为两部分。在线部分（交易前、交易中或交易后）是欺诈团队的明确领域，我们将花时间讨论。不过，在此之前，我们将研究与缓解相关的政策，以及问题的第二部分：接送点或返回点。这些部分经常被欺诈预防团队所忽视，除了欺诈团队可能更熟悉的在线识别和缓解流程的重要性之外，我们还想强调它们的重要性。

### 取货和退货：教育部门外的员工

该流程的取货或退货部分不由欺诈团队处理，而是由店内员工或有时来自企业仓库部分的员工处理。很容易基于这不是欺诈团队的责任而忽略流程的这一部分。但归根结底，欺诈团队有责任让这些员工意识到风险并培训他们如何处理这些风险。毕竟是欺诈。其他部门不知道欺诈。欺诈部门最终要为此负责。通常，这意味着欺诈预防领导者需要让管理层意识到这些问题，并解释为什么在业务的后勤或面向客户方面需要进一步培训，或许还需要改变流程。作为培训的一部分，优先考虑员工安全是至关重要的——很少有商店希望他们的员工卷入争吵，这也是应该强调的事情。
这种培训，包括教育你自己部门以外的员工，听起来工作量很大，但很值得；这是向管理层展示你的团队正在战略性地思考如何保护业务的好方法，它表明你处于当前趋势的顶端，并最终为你提供更多数据。那是因为你可以培训员工将有价值的信息反馈到你自己的检测系统中，并确保结构到位以实现这一点。与其他领域一样，与其他部门的合作对于制定真正有效的欺诈缓解策略至关重要。

### 政策决定：欺诈预防的一部分
BORIS 缓解的一部分是政策决定。阻止 BORIS 欺诈的最简单方法是制定一项商店政策，要求在取货时进行身份验证，并且当使用卡进行购买时，退货将记入该卡且仅记入该卡。该政策立即阻止了大部分 BORIS 欺诈行为。
另一方面，它会给好客户带来不太理想的体验，毕竟他们是绝大多数。合法客户可能更喜欢现金返还或商店信用 - 他们可能急需这笔钱，或者已经取消了该卡，或者他们正在派朋友或家人退货，等等。同样的卡政策可能会给这些客户带来严重的不便和烦恼。
确定它是否值得在一定程度上是一场数字游戏——在过去的一个月/季度/年度中，你有多少 BORIS 欺诈性回报？损失了多少？客户多久不想在他们用于购买的卡上退款？这在一定程度上也是一个经营理念的问题；一些公司在他们的优先事项列表中将客户体验置于如此高的位置，以至于甚至不会考虑这个选项。
像这样的政策决定不是欺诈团队应该自己做出的，但是如果 BORIS 欺诈开始成为一个严重的问题，那么与业务的相关部分进行讨论是很重要的。欺诈经理需要确保他们的声音作为政策讨论的一部分被听到。

#### 在线识别和缓解

为了在 BOPIS 和 BORIS 成为问题之前防止它们成为问题，在尝试下订单的交易点，欺诈团队依赖于他们在交易点使用的技术与其他形式的欺诈类似的技术。前面提到的 BOPIS-ATO 方法可以像防止标准 ATO 一样防止欺诈者创建一个帐户，然后潜入并在客户这样做之前提取合法订购的包裹；这里的挑战是 ATO 之一，而不是特定于 BOPIS/BORIS。然而，这是一个重要的信号，即使没有进行任何交易，团队也要认真对待 ATO 以保护帐户。 ATO 不应仅在交易时标记；如果你采用这种方法，每次攻击你的网站时，你都会错过这种欺诈趋势。
当 BOPIS/BORIS 欺诈攻击做得好且规模大时，它们的危险性最大——当它们变得足够有效以成为严重的连环犯罪时。请记住，由于始终涉及实物商品，因此当 BOPIS/BORIS 欺诈成功时，商店将损失两次；一次是向使用付款方式的受害者偿还，另一次是以货物本身 (BOPIS) 或现金退款 (BORIS) 的形式。这可以加起来，当它加起来时，它就会成为一个问题。在港口城市设有分支机构的零售商可能会看到这些商店特别有针对性，损失确实在增加——将货物从商店转移到发货是非常容易的。一旦欺诈者意识到这一点，他们自然会尝试重复骗局。出于这个原因，本章的其余部分侧重于识别和减少重复；发现系统中看似无关的用户或订单之间的链接。这通常与欺诈环有关 - 多个参与者多次攻击你的系统 - 尽管这也可能是一个特别坚定的参与者的迹象，而这些参与者似乎是许多不同的参与者。
在这种情况下，你真正想知道的是攻击背后的身份。你对这个身份或这个账户了解多少？此订单是否与以前的合法订单匹配？是新账号吗？
大规模实施 BOPIS/BORIS 攻击的欺诈者将确保他们的订单呈现不同的特征——它们将用于不同的商品，以不同的价格（尽管通常在一个粗略的价格范围内）并交付给不同的商店。如果欺诈者使用骡子，他们很可能会选择遍布全国的商店，在可能的情况下，尽可能地混淆图片。但是，专业的欺诈团队可以发现并使用相似之处或共同特征来识别并阻止此类欺诈。它可能是某种行为模式、设备类型或共享某种格式的电子邮件地址。
以下示例显示了共享相似 IP 的订单（共享相同的 C 类 - IPV4 点十进制形式的前三个八位字节，例如 1.1.1.1 和 1.1.1.2）。这种链接在掩盖其真实 IP 的欺诈者中相当普遍——他们可能正在使用代理，根据通常以这种方式而不是随机排序的列表转移到新 IP，或者他们可能正在使用 ISP/ VPN 服务，通常为用户分配一系列类似的 IP。
在表 8-1 所示的数据集中，类似 IP 的重复表明可能存在 BOPIS 欺诈：

1. 订单 1122 和 2233 可能代表位于蒙大拿州的欺诈者（或骡子，按照欺诈者的指示下订单）并计划在蒙大拿州的商店提取赃物。有两张被盗卡/账户被货币化，一张来自加利福尼亚，一张来自夏威夷。显然，这种模式总是有合理的解释（每天两个订单可能只是巧合），因此分析交易量至关重要。

2. 订单 3333、5555 和 6666 可能代表一个不在美国的欺诈者，而是使用代理/VPN 将他们“放置”在新罕布什尔州。看起来欺诈者选择这个代理是因为他们想匹配第一个受害者的账单状态，但在 1 月 30 日，他们变得懒惰并继续使用相同的 VPN 来窃取其他状态的凭据。 （骗子也是人，这样的懒惰对于骗子团队来说是非常宝贵的，所以值得警惕。）这个骗子还有一头骡子在亚利桑那州捡拾赃物。 1111 号令可能与这个欺诈者无关。

    | ORDERS.orderID | ORDERS.Order_Date | ORDERS.IP | ORDERS.IP_Geolocation_State | Selected_Pickup_Location_State | Billing_Address_State |
    | -------------- | ----------------- | --------- | --------------------------- | ------------------------------ | --------------------- |
    | 1111           | January 3         | 1.1.1.1   | New Hampshire               | New York                       | New Hampshire         |
    | 1122           | January 28        | 2.2.2.2   | Montana                     | Montana                        | California            |
    | 2233           | January 28        | 2.2.2.4   | Montana                     | Montana                        | Hawaii                |
    | 3333           | January 29        | 1.1.1.2   | New Hampshire               | Arizona                        | New Hampshire         |
    | 5555           | January 30        | 1.1.1.2   | New Hampshire               | Arizona                        | Ohio                  |
    | 6666           | January 30        | 1.1.1.3   | New Hampshire               | Arizona                        | Nebraska              |

    

你可以根据三天窗口的移动平均值查询最重要的攻击：

```sql
select 
C_Class_IP
,Order_Date
,  avg(daily_count) OVER(ORDER BY Order_Date
     ROWS BETWEEN 2 PRECEDING AND CURRENT ROW )
     as moving_average
from 
(SELECT SUBSTR(IP,1,INSTR(your_field,'.',1,3)-1) as C_Class_IP
, Order_Date
,Count(orderID) as daily_count
FROM ORDERS
Group by 1,2) as daily_count_nested_table;
```

请注意，如果你缺少某些日期的数据，则移动平均线将无法正常运行。如果你的数据库支持，请考虑使用日期偏移，或者选择更简单的方法，例如按 ISOweek 分组。如果你的数据集包含高季节性时期，请考虑使用加权移动平均线（这在 Python 中比在 SQL 中更容易实现）。
你可以清楚地看到这里的可疑模式，如果订单确实是不同人下的完全独立的订单，则显示不应该存在的订单之间的链接，但同样显示出太多差异，看起来像是同一个人合法下的订单。当然，这本身并不是欺诈的明确迹象 - 你需要寻找尽可能多的关联因素以确认你看到的是欺诈环。你在短时间内执行的订单之间确定的链接越多，你在处理此订单时就应该越谨慎。你可以做进一步的研究并直接拒绝，至少在一定的订单价值以上，或者你可以增加摩擦：打电话给客户；或要求处理物品取件或退货的团队使用强有力的客户身份证明；或不允许持卡人以外的任何人领取或退回物品；仅允许在 AVS 批准的帐单地址附近的商店取货或退货。当然，没有任何身份验证过程是万无一失的，但每个过程都会使欺诈者的生活更加艰难。如果你让你的商店太麻烦而无法攻击，他们只会搬到别处 - 正如我们所说，欺诈者会敏感地调整自己的投资回报率。不幸的是，在这种情况下，这就像逃离熊的笑话——你不需要是最快的，你只需要不是最慢的。在这种情况下，你不需要坚不可摧，你只需要比其他商店更难被攻击。
同时，请记住需要在欺诈预防和客户体验之间保持适当的平衡。增加摩擦可能有助于阻止欺诈，但也可能阻止好客户从你的商店订购。确保密切关注数字，以便了解 BOPIS/BORIS 在你的公司中有多少问题，以及客户对额外摩擦的反应。

## 概括

本章着眼于 BOPIS/BORIS 攻击方法，欺诈者利用这种取货/退货方法中的漏洞实施欺诈。我们研究了由于路边取货的增长而引入该过程的其他漏洞，以及在冠状病毒大流行期间变得普遍的做法。我们还研究了欺诈团队应采取的识别和阻止此类欺诈的方法——包括跨部门合作和培训，以及将订单和账户相互关联以识别不良行为模式。值得注意的是，当特定方法传播开来或被大量骡子同时使用时，这种链接方法将不起作用（因为除了共享知识或方法之外，不会有任何链接攻击）-这就是我们将在下一章中看到的内容。